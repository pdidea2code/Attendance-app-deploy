"use strict";(self.webpackChunk_coreui_coreui_free_react_admin_template=self.webpackChunk_coreui_coreui_free_react_admin_template||[]).push([[6466],{73981:(e,s,a)=>{a.r(s),a.d(s,{default:()=>o});var t=a(78983),n=a(72791),r=a(61134),i=a(57689),c=a(75985),l=(a(5462),a(28725)),d=a(80184);const o=()=>{const{register:e,handleSubmit:s,formState:{errors:a},setValue:o,watch:m,setError:u}=(0,r.cI)(),[h,x]=(0,n.useState)(!1),j=(0,i.s0)(),[p,b]=(0,n.useState)([]),[_,v]=(0,n.useState)({}),[f,k]=(0,n.useState)(""),[y,g]=(0,n.useState)(!1),[S,w]=(0,n.useState)({}),{state:C}=(0,i.TH)();(0,n.useEffect)((()=>{(async()=>{await(async()=>{x(!0);try{const e=(await(0,l.Yj)()).data.info.reduce(((e,s)=>{const a=s.name.split(".")[0];return e[a]||(e[a]=[]),e[a].push(s),e}),{});v(e);const s=Object.keys(e).reduce(((e,s)=>(e[s]=!1,e)),{});w(s)}catch(a){var e,s;c.Am.error((null===a||void 0===a||null===(e=a.response)||void 0===e||null===(s=e.data)||void 0===s?void 0:s.message)||"Error occurred")}finally{x(!1)}})(),C.editData&&(k(C.editData._id),o("name",C.editData.name))})()}),[C,o]);return(0,d.jsx)(d.Fragment,{children:(0,d.jsxs)("div",{className:"bg-light min-vh-100",children:[(0,d.jsx)(c.Ix,{}),(0,d.jsx)(t.KB,{className:"mt-3",children:(0,d.jsx)(t.rb,{children:(0,d.jsx)(t.b7,{md:6,children:(0,d.jsxs)(t.xH,{children:[(0,d.jsx)(t.bn,{children:"Role Form"}),(0,d.jsx)(t.sl,{children:(0,d.jsxs)(t.lx,{className:"row g-3",onSubmit:s((async e=>{const s=Object.keys(e).filter((s=>s.startsWith("permission_")&&!0===e[s])).map((e=>e.replace("permission_","")))||[];x(!0);try{if(""!==f){const a={name:e.name,id:f,permission:s};(await(0,l.AT)(a)).data.info&&j("/role")}else{const a={name:e.name,permission:s};(await(0,l._d)(a)).data.info&&j("/role")}}catch(n){var a,t;console.log(n),c.Am.error((null===n||void 0===n||null===(a=n.response)||void 0===a||null===(t=a.data)||void 0===t?void 0:t.message)||"An unknown error occurred")}finally{x(!1)}})),children:[(0,d.jsxs)(t.b7,{xl:12,md:12,children:[(0,d.jsx)(t.L8,{children:"Role Name"}),(0,d.jsx)(t.jO,{type:"text",placeholder:"Role Name",...e("name",{required:"Role Name is required"}),invalid:!!a.name}),a.name&&(0,d.jsx)(t.CO,{children:" Name is required"})]}),(0,d.jsx)(t.b7,{xl:12,md:12,children:(0,d.jsx)("b",{children:(0,d.jsx)(t.L8,{children:"Permission"})})}),(0,d.jsx)(t.EC,{type:"checkbox",label:"Select All Permissions",checked:y,onChange:e=>{const s=e.target.checked;g(s),Object.keys(_).forEach((e=>{_[e].forEach((e=>{o("permission_".concat(e._id),s)}))}))}}),h?(0,d.jsx)(t.LQ,{}):Object.keys(_).map((s=>(0,d.jsxs)("div",{children:[(0,d.jsx)(t.EC,{type:"checkbox",label:"Select All ".concat(s),checked:S[s],onChange:e=>((e,s)=>{const a=s.target.checked;w((s=>({...s,[e]:a}))),_[e].forEach((e=>{o("permission_".concat(e._id),a)}))})(s,e)}),_[s].map((s=>{var a,n;return(0,d.jsx)(t.EC,{type:"checkbox",label:s.name,defaultChecked:(null===C||void 0===C||null===(a=C.editData)||void 0===a||null===(n=a.permission)||void 0===n?void 0:n.includes(s.name))||!1,...e("permission_".concat(s._id),{type:"boolean"})},s._id)}))]},s))),(0,d.jsx)(t.b7,{md:12,className:"text-center submitButton",children:h?(0,d.jsxs)(t.u5,{disabled:!0,children:[(0,d.jsx)(t.LQ,{component:"span",size:"sm","aria-hidden":"true"}),"Loading..."]}):(0,d.jsx)(t.u5,{type:"submit",className:"AddButton",children:f?"Update":"Add"})})]})})]})})})})]})})}}}]);
//# sourceMappingURL=6466.96d443da.chunk.js.map