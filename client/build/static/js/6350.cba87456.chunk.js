"use strict";(self.webpackChunk_coreui_coreui_free_react_admin_template=self.webpackChunk_coreui_coreui_free_react_admin_template||[]).push([[6350],{24270:(e,t,s)=>{s.r(t),s.d(t,{default:()=>y});var a=s(78983),n=s(72791),r=s(59434),i=s(57689),o=s(28725),l=s(75985),d=(s(5462),s(62062),s(89078)),c=s(13474),m=s(80184);const h=e=>{let{props:t}=e;const[s,h]=(0,n.useState)([]),[u,x]=(0,n.useState)(!1),{id:y,month:p,year:j}=((0,i.s0)(),(0,r.I0)(),(0,r.v9)((e=>e.auth)),t);(0,n.useEffect)((()=>{(async()=>{x(!0);try{const e={id:y};p&&(e.month=p),j&&(e.year=j);const t=(await(0,o.MV)(e)).data.info;if(Array.isArray(t)){const e=await t.map((e=>({...e,modifyovertime:e.overtime?(0,o.gq)(e.overtime):"-",modifyworkingtime:e.workingtime?(0,o.gq)(e.workingtime):"-",modifyday:(0,c.WU)(e.day,"dd/MM/yyyy"),modifycheckin:e.checkin?(0,c.WU)(e.checkin,"hh:mm a"):"-",modifycheckout:e.checkout?(0,c.WU)(e.checkout,"hh:mm a"):"-"})));h(e)}}catch(s){var e,t;console.log(s),l.Am.error((null===s||void 0===s||null===(e=s.response)||void 0===e||null===(t=e.data)||void 0===t?void 0:t.message)||"An error occurred")}finally{x(!1)}})()}),[y,p,j]);return(0,m.jsx)(m.Fragment,{children:(0,m.jsx)("div",{id:"attendance",children:u?(0,m.jsx)("div",{className:"d-flex justify-content-center",children:(0,m.jsx)(a.LQ,{className:"theme-spinner-color"})}):(0,m.jsxs)(m.Fragment,{children:[(0,m.jsx)(l.Ix,{}),(0,m.jsx)(d.ZP,{title:"Attendance",data:s,columns:[{name:"modifyday",label:"day",options:{filter:!0,sort:!0}},{name:"modifycheckin",label:"checkin",options:{filter:!0,sort:!0}},{name:"modifycheckout",label:"checkout",options:{filter:!0,sort:!0}},{name:"location",label:"location",options:{filter:!0,sort:!0}},{name:"modifyworkingtime",label:"workingtime",options:{filter:!0,sort:!0}},{name:"modifyovertime",label:"overtime",options:{filter:!0,sort:!0}}],options:{}})]})})})};var u=s(61134);s(752);const x=e=>{let{props:t}=e;const[s,c]=(0,n.useState)([]),[h,u]=(0,n.useState)(""),[x,y]=(0,n.useState)(!1),p=((0,i.s0)(),(0,r.I0)()),j=(0,r.v9)((e=>e.auth)),[g,b]=(0,n.useState)([]),{id:f}=t,v=async()=>{try{const e={id:f},t=(await(0,o.QI)(e)).data.info;if(Array.isArray(t)){const e=await t.map((e=>({...e,modifydate:(0,o.vg)(e.date),modifytodate:e.todate?(0,o.vg)(e.todate):"-",modifyhour:e.hour?"".concat(e.hour," Hour "):"-",modifyapprovebyname:e.approvebyname?e.approvebyname:"-"})));c(e)}}catch(s){var e,t;console.log(s),l.Am.error((null===(e=s.response)||void 0===e||null===(t=e.data)||void 0===t?void 0:t.message)||"An error occurred")}finally{y(!1)}},k=async(e,t)=>{try{const s={id:e._id,status:t};await(0,o.wv)(s)}catch(n){var s,a;console.log(n),l.Am.error((null===(s=n.response)||void 0===s||null===(a=s.data)||void 0===a?void 0:a.message)||"An error occurred")}finally{v()}};(0,n.useEffect)((()=>{(async()=>{await(0,o.VQ)(p),b(j.permission)})()}),[]),(0,n.useEffect)((()=>{v()}),[]);const A=[{name:"modifydate",label:"date",options:{filter:!0,sort:!0}},{name:"modifytodate",label:"todate",options:{filter:!0,sort:!0}},{name:"modifyhour",label:"hour",options:{filter:!0,sort:!0}},{name:"type",label:"type",options:{filter:!0,sort:!0}},{name:"levaetype",label:"levaetype",options:{filter:!0,sort:!0}},{name:"day",label:"day",options:{filter:!0,sort:!0}},{name:"reson",label:"reson",options:{filter:!0,sort:!0}},{name:"modifyapprovebyname",label:"approveby",options:{filter:!0,sort:!0}},{name:"status",label:"status",options:{filter:!0,sort:!0,customBodyRender:e=>"Pending"===e?(0,m.jsx)("p",{style:{background:"#ffc800",color:"black",borderRadius:"20px",textAlign:"center",padding:"4px"},children:e}):"Rejected"===e?(0,m.jsx)("p",{style:{background:"red",color:"black",borderRadius:"20px",textAlign:"center",padding:"4px"},children:e}):"Approved"===e?(0,m.jsx)("p",{style:{background:"#00ff00",color:"black",borderRadius:"20px",textAlign:"center",padding:"4px"},children:e}):null}}];Array.isArray(g)&&g.includes("leave.edit")&&A.push({name:"_id",label:"Action",options:{filter:!1,sort:!1,customBodyRender:e=>{const t=s.find((t=>t._id===e));return"Approved"===t.status?(0,m.jsxs)(m.Fragment,{children:[(0,m.jsx)(a.u5,{className:"me-1 mb-1",style:{padding:"5px",background:"red",color:"black"},onClick:()=>{k(t,"Rejected")},children:"Reject"}),(0,m.jsx)(a.u5,{style:{padding:"5px",background:"#ffc800",color:"black"},onClick:()=>{k(t,"Pending")},children:"Pending"})]}):"Rejected"===t.status?(0,m.jsxs)(m.Fragment,{children:[(0,m.jsx)(a.u5,{className:"me-1 mb-1",style:{padding:"5px",background:"#00ff00",color:"black"},onClick:()=>{k(t,"Approved")},children:"Approv"}),(0,m.jsx)(a.u5,{style:{padding:"5px",background:"#ffc800",color:"black"},onClick:()=>{k(t,"Pending")},children:"Pending"})]}):"Pending"===t.status?(0,m.jsxs)(m.Fragment,{children:[(0,m.jsx)(a.u5,{className:"me-1 mb-1",style:{padding:"5px",background:"#00ff00",color:"black"},onClick:()=>{k(t,"Approved")},children:"Approv"}),(0,m.jsx)(a.u5,{style:{padding:"5px",background:"red",color:"black"},onClick:()=>{k(t,"Rejected")},children:"Reject"})]}):void 0}}});return(0,m.jsx)(m.Fragment,{children:x?(0,m.jsx)("div",{className:"d-flex justify-content-center",children:(0,m.jsx)(a.LQ,{className:"theme-spinner-color"})}):(0,m.jsxs)(m.Fragment,{children:[(0,m.jsx)(l.Ix,{}),(0,m.jsx)(d.ZP,{title:"Leave",data:s,columns:A,options:{},id:"leave"})]})})},y=()=>{var e;const{state:t}=(0,i.TH)(),[s,d]=(0,n.useState)({}),[y,p]=(0,n.useState)(""),j=(0,i.s0)(),[g,b]=(0,n.useState)([]),[f,v]=(0,n.useState)(!0),[k,A]=(0,n.useState)(!1),w=(0,r.I0)(),N=(0,r.v9)((e=>e.auth)),[S,_]=(0,n.useState)({}),[D,E]=(0,n.useState)(""),[I,P]=(0,n.useState)(""),{register:M,handleSubmit:R,formState:{errors:C},setValue:F,watch:q}=(0,u.cI)();function T(e){const t=new Date(e),s=t.getDate().toString().padStart(2,"0"),a=(t.getMonth()+1).toString().padStart(2,"0"),n=t.getFullYear();return"".concat(s,"/").concat(a,"/").concat(n)}const U=async function(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:null;A(!0);try{const s={id:t.editData._id};if(e&&e.date){const t=e.date.split("-");E(t[1]),P(t[0]),s.month=t[1],s.year=t[0]}const a=await(0,o.Sk)(s),n={totalhour:(0,o.gq)(a.data.info.totalhour),totalworkingtime:(0,o.gq)(a.data.info.totalworkingtime),totoalovertime:(0,o.gq)(a.data.info.totoalovertime),totoalattengance:a.data.info.totoalattengance,workingdays:a.data.info.workingdays,daysInMonth:a.data.info.daysInMonth};_(n),A(!1)}catch(n){var s,a;A(!1),console.log(n);const e=(null===(s=n.response)||void 0===s||null===(a=s.data)||void 0===a?void 0:a.message)||"Something went wrong";l.Am.error(e)}};return(0,n.useEffect)((()=>{(async()=>{try{await(0,o.VQ)(w),b(N.permission),Array.isArray(g)&&g.includes("attendance.view")&&U()}catch(e){l.Am.error("Failed to fetch permissions.")}finally{v(!1)}})()}),[]),(0,n.useEffect)((()=>{if(!t||!t.editData)return j("/employee"),null;d(t.editData),p(t.imageUrl+t.editData.image)}),[t,j]),(0,n.useEffect)((()=>{Array.isArray(N.permission)&&N.permission.includes("attendance.view")&&U(),F("date",(0,c.WU)(new Date,"yyyy-MM"))}),[]),f?(0,m.jsx)("div",{children:"Loading..."}):(0,m.jsx)(m.Fragment,{children:Array.isArray(g)&&g.includes("employee.profile")&&(0,m.jsxs)(a.KB,{children:[(0,m.jsx)(l.Ix,{}),(0,m.jsxs)(a.rb,{className:"justify-content-center",children:[(0,m.jsx)(a.b7,{md:12,xl:6,children:(0,m.jsxs)(a.xH,{className:"mb-4 shadow-sm",children:[(0,m.jsx)(a.bn,{className:"bg-primary text-white text-center",children:"Employee Profile"}),(0,m.jsx)(a.sl,{children:(0,m.jsxs)(a.rb,{children:[(0,m.jsx)(a.b7,{md:12,xl:4,className:"text-center mb-3",children:(0,m.jsx)(a.DW,{src:y,alt:"Employee",className:"img-fluid rounded-circle shadow-lg",style:{transition:"transform 0.3s ease",width:"150px",height:"150px"},onMouseOver:e=>e.target.style.transform="scale(1.1)",onMouseOut:e=>e.target.style.transform="scale(1)"})}),(0,m.jsx)(a.b7,{md:12,xl:8,children:(0,m.jsxs)(a.rb,{children:[(0,m.jsx)(a.b7,{md:12,className:"mb-3",children:(0,m.jsxs)("h5",{children:[(0,m.jsx)("strong",{children:"Name :"})," ",null===s||void 0===s?void 0:s.name]})}),(0,m.jsx)(a.b7,{md:12,className:"mb-3",children:(0,m.jsxs)("h6",{children:[(0,m.jsx)("strong",{children:"Email :"})," ",null===s||void 0===s?void 0:s.email]})}),(0,m.jsx)(a.b7,{md:12,className:"mb-3",children:(0,m.jsxs)("h6",{children:[(0,m.jsx)("strong",{children:"Phone no.:"})," ",null===s||void 0===s?void 0:s.phoneno]})}),(0,m.jsx)(a.b7,{md:12,className:"mb-3",children:(0,m.jsxs)("h6",{children:[(0,m.jsx)("strong",{children:"Date of birth :"})," ",T(null===s||void 0===s?void 0:s.dob)]})}),(0,m.jsx)(a.b7,{md:12,className:"mb-3",children:(0,m.jsxs)("h6",{children:[(0,m.jsx)("strong",{children:"Position :"})," ",null===s||void 0===s?void 0:s.position]})}),(0,m.jsx)(a.b7,{md:12,className:"mb-3",children:(0,m.jsxs)("h6",{children:[(0,m.jsx)("strong",{children:"Employee ID :"})," ",null===s||void 0===s?void 0:s.user_id]})}),(0,m.jsx)(a.b7,{md:12,className:"mb-3",children:(0,m.jsxs)("h6",{children:[(0,m.jsx)("strong",{children:"Account Open Date :"})," ",T(null===s||void 0===s?void 0:s.createdAt)]})})]})})]})}),(0,m.jsx)(a.Bt,{className:"text-center",children:Array.isArray(g)&&g.includes("employee.edit")&&(0,m.jsx)(a.u5,{color:"info",className:"text-white me-2",onClick:()=>j("/employeeform",{state:{editData:t.editData,imageUrl:t.imageUrl}}),children:"Edit Profile"})})]})}),Array.isArray(g)&&g.includes("attendance.view")&&(0,m.jsx)(a.b7,{md:12,xl:6,children:(0,m.jsxs)(a.xH,{className:"mb-4 shadow-sm",children:[(0,m.jsx)(a.bn,{className:"bg-primary text-white text-center",children:"Employee Attendance"}),(0,m.jsx)(a.sl,{children:(0,m.jsxs)(a.rb,{children:[(0,m.jsx)(a.b7,{md:12,xl:12,className:"mb-3",children:(0,m.jsxs)(a.lx,{className:"row g-3",onSubmit:R((async e=>{U(e);const t=e.date.split("-");E(t[1]),P(t[0])})),children:[(0,m.jsxs)(a.b7,{md:8,xl:8,children:[(0,m.jsx)(a.jO,{type:"month",...M("date",{required:"month is required"}),invalid:!!C.date}),(0,m.jsx)(a.CO,{invalid:!0,children:null===(e=C.date)||void 0===e?void 0:e.message})]}),(0,m.jsx)(a.b7,{md:4,xl:4,children:(0,m.jsx)(a.u5,{type:"submit",children:" Get"})})]})}),(0,m.jsx)(a.b7,{md:12,className:"mb-3",children:(0,m.jsxs)("h6",{children:[(0,m.jsx)("strong",{children:"Total Hour:"})," ",null===S||void 0===S?void 0:S.totalhour," hrs"]})}),(0,m.jsx)(a.b7,{md:12,className:"mb-3",children:(0,m.jsxs)("h6",{children:[(0,m.jsx)("strong",{children:"Total Working Time:"})," ",null===S||void 0===S?void 0:S.totalworkingtime," hrs"]})}),(0,m.jsx)(a.b7,{md:12,className:"mb-3",children:(0,m.jsxs)("h6",{children:[(0,m.jsx)("strong",{children:"Total Overtime:"})," ",null===S||void 0===S?void 0:S.totoalovertime," hrs"]})}),(0,m.jsx)(a.b7,{md:12,className:"mb-3",children:(0,m.jsxs)("h6",{children:[(0,m.jsx)("strong",{children:"Total Days:"})," ",null===S||void 0===S?void 0:S.daysInMonth," Days"]})}),(0,m.jsx)(a.b7,{md:12,className:"mb-3",children:(0,m.jsxs)("h6",{children:[(0,m.jsx)("strong",{children:"Working Days:"})," ",null===S||void 0===S?void 0:S.workingdays," Days"]})}),(0,m.jsx)(a.b7,{md:12,className:"mb-3",children:(0,m.jsxs)("h6",{children:[(0,m.jsx)("strong",{children:"Total Attendance:"})," ",null===S||void 0===S?void 0:S.totoalattengance," Days"]})})]})})]})}),Array.isArray(g)&&g.includes("attendance.view")&&(0,m.jsx)(a.b7,{md:12,xl:12,className:"mb-4",children:(0,m.jsx)(h,{props:{id:s._id,month:D,year:I}})}),Array.isArray(g)&&g.includes("leave.view")&&(0,m.jsx)("div",{id:"leave",children:(0,m.jsx)(a.b7,{md:12,xl:12,children:(0,m.jsx)(x,{props:{id:s._id}})})})]})]})})}}}]);
//# sourceMappingURL=6350.cba87456.chunk.js.map